# Lumina Note 鑷爺鎺掔増寮曟搸璁″垝锛圵YSIWYG 鎵撳嵃鐩爣锛?
鐩爣锛氬湪 Lumina Note 鍐呭疄鐜扳€滅焊寮犵骇鎺掔増 + AI 鎺掔増鎸囦护鈥濓紝淇濊瘉**鍚屼竴鍙版満鍣?*涓婄殑棰勮涓庢墦鍗颁竴鑷达紙WYSIWYG锛夈€?瀹屾垚涓€涓噷绋嬬鍚庯紝蹇呴』鍦ㄦ鏂囨。涓爣娉ㄥ凡缁忓畬鎴?## 鑳屾櫙涓庣幇鏈夎兘鍔?- 鏈湴浼樺厛 + Tauri 妗岄潰搴旂敤
- AI Agent + RAG 璇箟妫€绱?- Markdown 缂栬緫鍣紙CodeMirror锛? LaTeX/Mermaid/浠ｇ爜楂樹寒
- 鐭ヨ瘑鍥捐氨銆丳DF 鎵规敞銆佹暟鎹簱瑙嗗浘锛堣〃鏍?鐪嬫澘锛夈€乄ebDAV 鍚屾绛?
## 鐜版湁鎶€鏈爤锛堥€夊瀷绾︽潫锛?- 妗嗘灦锛歍auri v2锛圧ust + WebView锛?- 鍓嶇锛歊eact 18 + TypeScript + Vite + Tailwind CSS
- 缂栬緫鍣細CodeMirror 6锛圡arkdown锛?- 鐘舵€佺鐞嗭細Zustand
- 鏁版嵁灞傦細SQLite
- PDF 鐩稿叧锛歱dfjs-dist/react-pdf銆乯sPDF
- 娴嬭瘯锛歏itest锛堝崟娴嬶級銆丳laywright core锛堢鍒扮锛?
## 鏍稿績鐩爣锛圡VP锛?- 绾稿紶绾ф帓鐗堬細A4/Letter銆侀〉杈硅窛銆侀〉鐪夐〉鑴氥€佸垎椤点€佹钀?瀛椾綋绮剧‘鎺у埗銆?- AI 鎺掔増鎸囦护锛氫腑鏂?鑻辨枃鍒嗗埆鎸囧畾瀛椾綋涓庡瓧鍙凤紙濡傚皬鍥涘畫浣?+ Times New Roman锛夈€佽璺濄€佹钀界缉杩涚瓑銆?- 棰勮涓庢墦鍗颁竴鑷达細缁熶竴浠?**PDF锛堝祵鍏ュ瓧浣擄級** 浣滀负鎵撳嵃杈撳嚭婧愩€?- `.docx` 鏀寔涓衡€滃彲缂栬緫妯″紡鈥濓紝鍙鐩栧父鐢ㄥ瓙闆嗭紙娈佃惤/鏍囬/鍒楄〃/琛ㄦ牸/鍥剧墖/椤电湁椤佃剼锛夈€?- 寮曟搸闇€鍙娊绂讳负鐙珛椤圭洰锛屼究浜庡悗缁紑婧愬彂甯冧笌澶嶇敤銆?
## 闈炵洰鏍囷紙鏄庣‘涓嶅仛锛?- `.doc` 鑰佹牸寮?- 澶嶆潅 Word 鐗规€э細瀹忋€佷慨璁€佸煙銆佸鏉傝剼娉?灏炬敞銆佹诞鍔ㄥ浘鏂囩幆缁曘€佸祵濂楀鏉傝〃鏍肩瓑
- 璺ㄥ钩鍙?100% 涓€鑷达紙Word 鑷韩涔熸棤娉曚繚璇侊級锛屽彧淇濊瘉**鍚屾満棰勮=鎵撳嵃**

## 鍏抽敭绛栫暐
- **纭畾鎬ф帓鐗?*锛氬悓涓€杈撳叆銆佸悓涓€瀛椾綋銆佸悓涓€鐜 鈫?杈撳嚭鐗堥潰涓€鑷淬€?- **瀛椾綋鍙帶**锛氬厑璁镐娇鐢ㄧ郴缁熷瓧浣擄紝浣嗕紭鍏堟彁渚涘紑婧愭浛浠ｄ笌瀛椾綋鏄犲皠锛涙墦鍗颁竴寰嬩娇鐢?PDF 瀛椾綋宓屽叆銆?- **缁撴瀯鍖栨帓鐗堟寚浠?*锛欰I 杈撳嚭蹇呴』钀藉埌绋冲畾鐨?JSON/DSL锛屽啀鐢卞紩鎿庢墽琛屻€?
## PDF 杈撳嚭涓庢墦鍗版祦绋嬶紙鏄庣‘锛?- 棰勮锛氱粺涓€璧板悓涓€濂楁帓鐗堜笌 PDF 娓叉煋绠＄嚎锛岄瑙堥〉鏉ヨ嚜 PDF 娓叉煋杈撳嚭銆?- 瀵煎嚭锛氱敓鎴愬敮涓€鐨勫祵鍏ュ瓧浣?PDF锛屼綔涓烘墦鍗颁笌浜や粯鍩哄噯銆?- 鎵撳嵃锛氫粎浠庡鍑虹殑 PDF 鎵撳嵃锛岀姝㈢洿鎺ヤ粠 DOM/Canvas 鎵撳嵃锛涢粯璁ゅ叧闂缉鏀俱€?
---

## 榛樿鎶€鏈爤锛堝彲淇敼锛岄粯璁ゅ嵆鎵ц锛?> 涓轰簡璁╁惊鐜兘鏃犻樆鎺ㄨ繘锛屽厛閿佸畾榛樿鎶€鏈矾寰勩€?
- 鏈€缁堝喅瀹氾紙M0锛夛細閿佸畾浠ヤ笅榛樿鎶€鏈爤锛涜嫢闇€鏀瑰姩锛屽繀椤诲湪姝よ妭璁板綍鍘熷洜銆?- 璇█锛歊ust锛堟牳蹇冩帓鐗堝紩鎿庯級+ TS/React锛圲I 棰勮锛?- 瀛椾綋涓庢帓鐗堬細HarfBuzz锛坰haping锛? rustybuzz/harfbuzz-rs 閫変竴鏉℃垚鐔?binding
- 瀛椾綋鍙戠幇锛歠ont-kit 鎴栫郴缁?API锛圵indows DirectWrite / macOS CoreText / Linux fontconfig锛?- PDF 杈撳嚭锛歱df-writer / lopdf锛堜簩閫変竴锛屼紭鍏?pdf-writer锛? 瀛椾綋宓屽叆
- 娓叉煋锛歋kia锛坰kia-safe锛夋垨鑷爺鐭㈤噺娓叉煋锛涢粯璁ゅ厛璧?PDF 浣滀负娓叉煋鍩哄噯

鑻ラ渶鏀瑰姩鎶€鏈爤锛屽厛鏇存柊鏈妭骞惰褰曞師鍥犮€?
---

## 鐩綍缁撴瀯鑽夋锛堝紩鎿庡彲鎶界锛?```
engine/
  Cargo.toml
  src/
    model/            # 鏂囨。妯″瀷涓庢牱寮?    text/             # 瀛椾綋鍔犺浇銆乻haping銆佹柇琛?    layout/           # 娈佃惤甯冨眬銆佸垎椤?    render/           # 娓叉煋鍣ㄤ笌PDF杈撳嚭
    io_docx/          # docx 瀛愰泦瀵煎叆瀵煎嚭
    ai/               # AI 鎸囦护瑙ｆ瀽涓庢槧灏?  tests/
    fixtures/
    golden/
```

---

## 鏋舵瀯鎷嗗垎锛堟ā鍧楋級
1) 鏂囨。妯″瀷锛圖ocument Model锛?   - Block/Inline 鏍戙€佹牱寮忕户鎵裤€佹钀?瀛楃鏍峰紡
   - 鎿嶄綔妯″瀷锛堟彃鍏?鍒犻櫎/鏍峰紡鍙樻洿锛? 鍘嗗彶璁板綍
2) 瀛椾綋涓庢枃鏈紩鎿庯紙Font + Text Shaping锛?   - 瀛椾綋鍔犺浇/鍥為€€銆佸瓧褰㈠害閲?   - CJK + Latin 娣锋帓銆佽鍐呮柇琛岃鍒?3) 鎺掔増寮曟搸锛圠ayout Engine锛?   - 琛屽唴甯冨眬銆佹钀藉竷灞€銆佸垎椤?   - 瀛よ/瀵¤鎺у埗銆侀〉鐪夐〉鑴氬竷灞€
4) 娓叉煋涓庤緭鍑猴紙Renderer + Export锛?   - 鍒嗛〉棰勮娓叉煋
   - PDF 瀵煎嚭锛堝祵鍏ュ瓧浣擄級
   - 鎵撳嵃璺緞浣跨敤 PDF 杈撳嚭
5) AI 鎺掔増鎸囦护绠＄嚎锛圓I 鈫?Layout Ops锛?   - 鑷劧璇█ 鈫?缁撴瀯鍖?schema
   - 楠岃瘉銆佸綊涓€鍖栥€佸簲鐢ㄥ埌鏂囨。
6) 瀵煎叆瀵煎嚭锛圖ocx Subset IO锛?   - `.docx` 瀛愰泦瀵煎叆銆佹牱寮忔槧灏?   - `.docx` 瀛愰泦瀵煎嚭锛堝彲缂栬緫妯″紡锛?
---

## AI 鎺掔増鎸囦护 Schema锛堣崏妗堬級
> AI 涓嶇洿鎺ョ敓鎴?CSS/HTML锛屽彧鐢熸垚缁撴瀯鍖栨寚浠わ紝閬垮厤涓嶇‘瀹氭€с€?
```json
{
  "page": { "size": "A4", "margin": "25mm", "headerHeight": "12mm" },
  "typography": {
    "zh": { "font": "SimSun", "size": "12pt" },
    "en": { "font": "Times New Roman", "size": "12pt" }
  },
  "paragraph": {
    "lineHeight": 1.6,
    "indent": "2em",
    "align": "justify"
  }
}
```

---

## AI 浣跨敤鍦烘櫙锛堜紭鍏堢骇锛?> 浣滀负鍚庣画瀹炵幇鐨勪紭鍏堢骇渚濇嵁锛堜粠楂樺埌浣庯級銆?
### P0锛氳嚜鐒惰瑷€鎺掔増
- 鐢ㄦ埛 prompt锛氳鎸?A4 鎺掔増锛屼腑鏂囧皬鍥涘畫浣擄紝鑻辨枃 Times New Roman锛岃璺?1.5锛岄琛岀缉杩?2 瀛楃锛屾爣棰?1 灞呬腑鍔犵矖 16pt锛屾爣棰?2 宸﹀榻?14pt锛岄〉鐪夆€滅爺绌舵姤鍛娾€濓紝椤佃剼灞呬腑椤电爜銆?
### P0锛氭櫤鑳藉垎椤典慨姝?- 鐢ㄦ埛 prompt锛氳閬垮厤瀛よ/瀵¤锛屾爣棰樹笉钀藉湪椤靛熬锛屽浘琛ㄤ笌鏍囬鍚岄〉锛涘鏋滈渶瑕侊紝鑷姩璋冩暣娈靛墠娈靛悗涓庤璺濆井璋冦€?
### P1锛氭壒閲忚鑼冨寲
- 鐢ㄦ埛 prompt锛氬皢褰撳墠鏂囨。鎵€鏈夋鏂囩粺涓€涓哄皬鍥涘畫浣擄紝鑻辨枃缁熶竴 Times New Roman锛涙爣棰樺眰绾т繚鎸佷笉鍙樹絾瀛楀彿鍒嗗埆鏀逛负涓€/浜?涓夌骇 16/14/12pt锛屽苟涓ょ瀵归綈銆?
### P1锛氭ā鏉垮寲鎶ュ憡鐢熸垚
- 鐢ㄦ埛 prompt锛氭寜鍏徃鎶ュ憡妯℃澘鎺掔増锛氶〉杈硅窛涓?25mm 涓?20mm 宸﹀彸 25mm锛岄〉鐪?12mm锛岄〉鑴?12mm锛屾鏂囦袱绔榻愶紝鏍囬鍒嗙骇涓庣洰褰曡嚜鍔ㄧ敓鎴愩€?
### P2锛氬弻璇唴瀹规帓鐗?- 鐢ㄦ埛 prompt锛氫腑鏂囨钀界敤瀹嬩綋灏忓洓锛岃嫳鏂囨钀界敤 Times New Roman 12pt锛岃嫳鏂囨钀藉乏瀵归綈銆佷腑鏂囦袱绔榻愶紝绔犺妭鏍囬涓嫳鏂囧垎琛屾樉绀恒€?
### P2锛氭墦鍗颁氦浠樼増
- 鐢ㄦ埛 prompt锛氱敓鎴愬彲鎵撳嵃鐗堟湰锛岃緭鍑轰负宓屽叆瀛椾綋鐨?PDF锛屼繚鎸侀瑙堜笌鎵撳嵃涓€鑷淬€?
---

## Docx 瀛愰泦鑼冨洿锛圡VP锛?| 绫诲埆 | 鏀寔 | 澶囨敞 |
|---|---|---|
| 娈佃惤 | 鉁?| 瀵归綈銆佺缉杩涖€佽璺濄€佹鍓嶆鍚?|
| 鏍囬 | 鉁?| H1-H3 鏄犲皠 |
| 瀛椾綋 | 鉁?| 涓?鑻卞垎鍒瓧浣撱€佸瓧鍙枫€佸姞绮?鏂滀綋 |
| 鍒楄〃 | 鉁?| 鏈夊簭/鏃犲簭 |
| 琛ㄦ牸 | 鉁?| 绠€鍗曡〃鏍硷紝涓嶅惈澶嶆潅鍚堝苟涓庤法椤?|
| 鍥剧墖 | 鉁?| 琛屽唴/娈佃惤绾?|
| 椤电湁椤佃剼 | 鉁?| 鏂囨湰涓庨〉鐮?|
| 鑴氭敞/灏炬敞 | 鉂?| MVP 涓嶅仛 |
| 淇/鎵规敞 | 鉂?| MVP 涓嶅仛 |

---

## 閲岀▼纰戣鍒掕〃锛堢粏鍖栵級

> 姣忎釜閲岀▼纰戝寘鍚細Scope / Deliverables / How to verify / Expected outcome

| Milestone | Scope | Deliverables | How to verify | Expected outcome |
|---|---|---|---|---|
| M0: 鐩爣涓庤鑼?| MVP 鑼冨洿銆侀潪鐩爣銆佽緭鍑虹瓥鐣?| 闇€姹傛枃妗?+ Schema 鑽夋 + 瀛椾綋绛栫暐鑽夋 | 璇勫閫氳繃锛屽舰鎴愬喕缁撴竻鍗?| 鐩爣涓庤竟鐣屾竻鏅?|
| M1: 鏂囨。妯″瀷 | Block/Inline 鏍戙€佹牱寮忕户鎵裤€佹搷浣滄ā鍨?| Model + JSON 搴忓垪鍖栨牸寮?| 鍩烘湰缂栬緫 ops 鍙洖鏀?| 鏂囨。缁撴瀯绋冲畾 |
| M2: 瀛椾綋灞?| 瀛椾綋鍔犺浇/鍥為€€/娴嬮噺 | 瀛椾綋绠＄悊鍣?+ 鍥為€€琛?| 瀛椾綋缂哄け鍙彁绀轰笖鍥為€€涓€鑷?| 瀛椾綋鍙帶 |
| M3: 琛屽唴鎺掔増 | 琛屽唴甯冨眬銆佹柇琛岃鍒欍€佹贩鎺掑鐞?| Line layout 寮曟搸 | 鍩哄噯鏂囨湰琛屽搴︿竴鑷?| 琛屽唴鎺掔増鍙敤 |
| M4: 娈佃惤甯冨眬 | 娈佃惤缂╄繘銆佸榻愩€佽璺?| Paragraph layout | 鍏稿瀷娈佃惤鎺掔増姝ｇ‘ | 娈佃惤鎺掔増鍙敤 |
| M5: 鍒嗛〉 | 椤佃竟璺濄€佸垎椤点€侀〉鐪夐〉鑴?| Pagination engine | 鍚屾牱杈撳叆鍒嗛〉绋冲畾 | 鍒嗛〉鍙敤 |
| M6: 棰勮娓叉煋 | 鍒嗛〉棰勮瑙嗗浘銆佹粴鍔?| Page viewer | 棰勮涓庡竷灞€涓€鑷?| 鍙鍖栭瑙堝畬鎴?|
| M7: PDF 杈撳嚭 | PDF 娓叉煋涓庡瓧浣撳祵鍏?| PDF exporter | 棰勮涓?PDF 瀵归綈 | 鎵撳嵃鍩虹瀹屾垚 |
| M8: 鎵撳嵃鏍″噯 | 鎵撳嵃杈硅窛/缂╂斁绛栫暐 | 鎵撳嵃璁剧疆涓庢牎鍑嗘寚鍗?| 鎵撳嵃缁撴灉涓庨瑙堜竴鑷?| 鍚屾満 WYSIWYG |
| M9: AI 鎺掔増 | AI 鎸囦护瑙ｆ瀽 + 搴旂敤 | Schema 楠岃瘉 + 鎿嶄綔鏄犲皠 | 鎸囦护鍙鐜般€佸彲鍥炴粴 | AI 鎺掔増鍙敤 |
| M10: Docx 瀵煎叆 | `.docx` 瀛愰泦瑙ｆ瀽 | Importer + 鏄犲皠琛?| 甯歌 docx 鍙鍏?| 鍙紪杈戝鍏?|
| M11: Docx 瀵煎嚭 | `.docx` 瀛愰泦瀵煎嚭 | Exporter + 鍏煎璇存槑 | Word 鎵撳紑鍙紪杈?| 鍙紪杈戝鍑?|
| M12: 娴嬭瘯涓庢€ц兘 | golden PDFs + layout diff | 鍥炲綊鐢ㄤ緥 + 鎬ц兘鎸囨爣 | CI 涓彲閲嶅楠岃瘉 | 宸ョ▼绋冲畾鍙凯浠?|

---

## 閲岀▼纰戜换鍔℃媶鍒嗭紙鍙洿鎺ユ墽琛岋級
> 姣忎釜鏉＄洰鏄€滃崟娆″惊鐜彲瀹屾垚鈥濈殑鏈€灏忎换鍔″崟浣嶃€?
### M0 鐩爣涓庤鑼?- [x] 鍥哄寲鎶€鏈爤閫夋嫨骞跺湪鈥滈粯璁ゆ妧鏈爤鈥濅腑鏍囪鏈€缁堝喅瀹?- [x] 鏄庣‘ PDF 杈撳嚭涓庢墦鍗版祦绋嬶紙棰勮 -> PDF -> 鎵撳嵃锛?- [x] 鍐欏嚭 WYSIWYG 楠屾敹闃堝€硷紙鍍忕礌/姣背锛?
### M1 鏂囨。妯″瀷
- [ ] 瀹氫箟鏂囨。鏍戣妭鐐圭被鍨嬶紙Paragraph/Heading/List/Table/Image锛?- [ ] 瀹氫箟鏍峰紡缁撴瀯锛團ontStyle/ParagraphStyle/PageStyle锛?- [ ] 璁捐鏈€灏?ops锛坕nsert/delete/applyStyle锛?- [ ] 纭畾搴忓垪鍖栨牸寮忥紙JSON schema 鑽夋锛?
### M2 瀛椾綋灞?- [ ] 瀛椾綋鍙戠幇锛氬垪鍑虹郴缁熷瓧浣?+ fallback 瑙勫垯
- [ ] 瀛椾綋鍔犺浇锛氫粠璺緞鍔犺浇骞剁紦瀛樺害閲?- [ ] 瀛椾綋鏄犲皠琛細涓枃/鑻辨枃榛樿鏄犲皠

### M3 琛屽唴鎺掔増
- [ ] 闆嗘垚 shaping锛屽緱鍒?glyph runs
- [ ] 瀹炵幇鏂锛堟寜瀹藉害鎶樿锛?- [ ] 瀹炵幇娣锋帓鍚堝苟锛圕JK + Latin锛?
### M4 娈佃惤甯冨眬
- [ ] 娈佃惤琛岃窛涓庡榻愶紙宸?涓?鍙?涓ょ锛?- [ ] 棣栬缂╄繘涓庢鍓嶆鍚?
### M5 鍒嗛〉
- [ ] Page model锛堢焊寮犲昂瀵搞€佽竟璺濄€佸彲鐢ㄥ尯锛?- [ ] 椤电湁椤佃剼甯冨眬
- [ ] 绠€鍗曞垎椤碉紙鎸夊潡娴佸紡鍒囬〉锛?- [ ] 鍩虹瀛よ/瀵¤澶勭悊锛堟渶灏忓疄鐜帮級

### M6 棰勮娓叉煋
- [ ] 娓叉煋 pipeline锛氬竷灞€鏍?-> 棰勮椤甸潰
- [ ] 鍩虹缂╂斁涓庡垎椤垫祻瑙?
### M7 PDF 杈撳嚭
- [ ] PDF 鏂囨。鐢熸垚
- [ ] 瀛椾綋宓屽叆涓庡瓧浣撳瓙闆?- [ ] PDF 涓庨瑙堝榻愰獙璇?
### M8 鎵撳嵃鏍″噯
- [ ] 鎵撳嵃璁剧疆鎸囧崡锛堢鐢ㄧ缉鏀俱€佺焊寮犲尮閰嶏級
- [ ] 杈硅窛鏍″噯娴佺▼锛堣褰曡澶囧亸宸級

### M9 AI 鎺掔増
- [ ] 瀹氫箟 AI schema 鏍￠獙锛坺od锛?- [ ] 瑙ｆ瀽鑷劧璇█ -> schema锛堟渶灏忚鍒欙級
- [ ] schema -> 鏍峰紡搴旂敤鍒版枃妗?
### M10 Docx 瀵煎叆
- [ ] 瑙ｆ瀽娈佃惤/鏍囬/瀛椾綋鏍峰紡
- [ ] 瑙ｆ瀽鍒楄〃銆佺畝鍗曡〃鏍笺€佸浘鐗?- [ ] 椤电湁椤佃剼瀵煎叆

### M11 Docx 瀵煎嚭
- [ ] 杈撳嚭娈佃惤/鏍囬/瀛椾綋鏍峰紡
- [ ] 杈撳嚭鍒楄〃銆佺畝鍗曡〃鏍笺€佸浘鐗?- [ ] 杈撳嚭椤电湁椤佃剼涓庨〉鐮?
### M12 娴嬭瘯涓庢€ц兘
- [ ] golden fixture锛氱煭鏂囨。 / 闀挎枃妗?/ 鍙岃鏂囨。
- [x] 甯冨眬 diff 宸ュ叿锛堝儚绱犳垨甯冨眬鎸囨爣锛?- [x] 鎬ц兘鍩哄噯锛堝垎椤佃€楁椂銆丳DF 鐢熸垚鑰楁椂锛?
---

## WYSIWYG 鎵撳嵃楠屾敹鏍囧噯锛堝悓鏈猴級
- 鍚屼竴鍙版満鍣ㄣ€佸悓涓€瀛椾綋鐜涓嬶細棰勮涓?PDF 杈撳嚭鐗堥潰涓€鑷达紙灏哄/鍒嗛〉/琛岃窛璇樊 < 1px锛夈€?- 鎵撳嵃浣跨敤 PDF 杈撳嚭锛屽叧闂缉鏀撅紙No scaling锛夛紝鎵撳嵃缁撴灉涓庨瑙堜竴鑷淬€?- 瀛椾綋宓屽叆淇濊瘉璺ㄨ澶囪瑙変竴鑷达紙鍗充娇缂栬緫鎬т笅闄嶏級銆?
- Acceptance thresholds (same machine, preview vs exported PDF):
- Page size delta <= 0.2mm (<= 1px @ 96dpi).
- Margin box delta <= 0.2mm; header/footer baseline delta <= 0.2mm.
- Line spacing delta <= 0.2mm; glyph baseline delta <= 1px.
- Page break positions identical; max drift <= 1px.

---

## 椋庨櫓涓庢敞鎰忎簨椤?- 瀛椾綋鎺堟潈锛氬晢涓氬瓧浣撲笉鑳介殢杞欢鍒嗗彂锛屽彧鑳戒娇鐢ㄧ郴缁熷畨瑁呮垨寮€婧愭浛浠ｃ€?- Word 鍏煎锛歚.docx` 涓哄彲閲嶆帓鏍煎紡锛岀紪杈戞ā寮忔棤娉曚繚璇佺粷瀵逛竴鑷淬€?- CJK 鎺掔増缁嗚妭澶嶆潅锛氭柇琛屻€佹爣鐐规尋鍘嬨€佸瓧鍙锋槧灏勯渶閫愭杩唬銆?

